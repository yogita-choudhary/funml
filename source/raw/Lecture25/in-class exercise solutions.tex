\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath, amssymb}
\usepackage{enumitem}

\begin{document}

\begin{center}
{\Large \textbf{In-Class Exercise --- Solutions}}\\[6pt]
{\large \textbf{Lecture 25: Data and Label Efficient Learning (Active Learning)}}
\end{center}

\vspace{8pt}

\noindent
Predicted probabilities:

\[
p(y|x_1)=[0.80,\;0.10,\;0.10],\quad
p(y|x_2)=[0.34,\;0.33,\;0.33]
\]
\[
p(y|x_3)=[0.50,\;0.49,\;0.01],\quad
p(y|x_4)=[0.60,\;0.20,\;0.20]
\]

\vspace{10pt}
\noindent
\textbf{Solutions:}
\begin{enumerate}[label=(\arabic*), itemsep=10pt]

\item \textbf{Entropy for $x_1$ and $x_2$:}

\[
H(x)=-\sum_{c=1}^{3} p_c \ln(p_c)
\]

For $x_1$:
\[
H(x_1)=-(0.80\ln0.80+0.10\ln0.10+0.10\ln0.10)
\]
\[
\approx -(0.80(-0.2231)+0.10(-2.3026)+0.10(-2.3026))
\]
\[
\approx 0.64
\]
\[
\boxed{H(x_1)\approx 0.64}
\]

For $x_2$:
\[
H(x_2)=-(0.34\ln0.34+0.33\ln0.33+0.33\ln0.33)
\]
\[
\approx -(0.34(-1.0788)+0.33(-1.1087)+0.33(-1.1087))
\]
\[
\approx 1.10
\]
\[
\boxed{H(x_2)\approx 1.10}
\]

\[
\boxed{x_2\text{ has higher entropy.}}
\]

\item \textbf{Least Confidence:} $LC(x)=1-\max_c p_c$

\[
LC(x_1)=1-0.80=0.20
\]
\[
LC(x_2)=1-0.34=0.66
\]
\[
LC(x_3)=1-0.50=0.50
\]
\[
LC(x_4)=1-0.60=0.40
\]

Largest $LC$ means least confident:
\[
\boxed{x_2\text{ is selected first (LC = 0.66).}}
\]

\item \textbf{Margin Sampling:} $M(x)=p_{(1)}-p_{(2)}$

\[
M(x_1)=0.80-0.10=0.70
\]
\[
M(x_2)=0.34-0.33=0.01
\]
\[
M(x_3)=0.50-0.49=0.01
\]
\[
M(x_4)=0.60-0.20=0.40
\]

Smallest margin is most uncertain:
\[
\boxed{x_2\text{ or }x_3\text{ (tie at margin }0.01\text{).}}
\]

\item \textbf{Early vs late stage strategy:}

In fusion-based active learning:
\begin{itemize}
\item Early stage emphasizes \textbf{diversity-based} selection to represent the global distribution.
\item Later stage emphasizes \textbf{difficulty-based} selection near decision boundaries.
\end{itemize}

\[
\boxed{\text{Early stage: diversity-based selection}}
\]

\end{enumerate}

\vspace{8pt}
\noindent
\textbf{Final answers:}
\[
\boxed{H(x_1)=0.64,\;H(x_2)=1.10,\;\text{LC picks }x_2,\;\text{Margin picks }x_2/x_3,\;\text{Early: diversity}}
\]

\end{document}
