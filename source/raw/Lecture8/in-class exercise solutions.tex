\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath, amssymb}
\usepackage{enumitem}

\begin{document}

\begin{center}
{\Large \textbf{In-Class Exercise --- Solutions}}\\[6pt]
{\large \textbf{Lecture 8: Polynomial Regression (Gradient Descent Iterations)}}
\end{center}

\vspace{8pt} 
\section{Question} 
\noindent
\textbf{Context (from lecture):} In Gradient Descent training,
\begin{itemize}
\item \textbf{Batch GD:} 1 iteration per epoch.
\item \textbf{Stochastic GD:} $N$ iterations per epoch.
\item \textbf{Mini-batch GD:} $N/b$ iterations per epoch.
\end{itemize}

\vspace{6pt}
\noindent
\textbf{Given:}
\[
N = 1{,}000{,}000,
\qquad
P = 100,
\qquad
b = 10{,}000
\]

\vspace{8pt}
\noindent
\textbf{Tasks:}
\begin{enumerate}[label=(\arabic*), itemsep=8pt]
\item (\textbf{Iterations per epoch}) Compute the number of iterations in \textbf{one epoch} for:
\begin{enumerate}[label=(\alph*), itemsep=4pt]
\item Batch GD
\item Stochastic GD
\item Mini-batch GD (batch size $b=10{,}000$)
\end{enumerate}

\item (\textbf{Memory constraint}) Suppose you can process at most $50{,}000$ data points at a time.
Which methods can be used \textbf{without exceeding} this memory limit?
\begin{enumerate}[label=(\alph*), itemsep=4pt]
\item Only Stochastic GD
\item Stochastic GD and Mini-batch GD with $b \le 50{,}000$
\item Batch GD and Mini-batch GD with $b = 50{,}000$
\item All methods
\end{enumerate}

\item (\textbf{Multiple epochs}) If you perform \textbf{10 epochs} of Mini-batch GD with batch size $b=20{,}000$,
how many total iterations will you run?
\end{enumerate}

\vspace{6pt}
\noindent
\textbf{Answers should be exact integers.}


%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%


\vspace{8pt}
\section{Solutions}
\noindent
\textbf{Given:}
\[
N = 1{,}000{,}000,
\qquad
b = 10{,}000
\]

\vspace{10pt}
\noindent
\textbf{Solutions:}

\begin{enumerate}[label=(\arabic*), itemsep=10pt]

\item \textbf{Iterations per epoch}
\begin{enumerate}[label=(\alph*), itemsep=6pt]
\item Batch GD: One update uses the entire dataset $\Rightarrow \boxed{1 \text{ iteration}}$.
\item Stochastic GD: One update per sample $\Rightarrow \boxed{N = 1{,}000{,}000 \text{ iterations}}$.
\item Mini-batch GD: One update per batch $\Rightarrow \boxed{N/b = 1{,}000{,}000/10{,}000 = 100 \text{ iterations}}$.
\end{enumerate}

\item \textbf{Memory constraint}
Batch GD must process all $N=1{,}000{,}000$ points at once (too large).
Stochastic uses 1 point.
Mini-batch works if $b \le 50{,}000$.
\[
\boxed{\text{Correct choice: (b)}}
\]

\item \textbf{10 epochs of Mini-batch GD with $b=20{,}000$}
\[
\text{Batches per epoch} = N/b = 1{,}000{,}000/20{,}000 = 50
\]
\[
\text{Total iterations} = 10 \times 50 = \boxed{500}
\]

\end{enumerate}

\vspace{8pt}
\noindent
\textbf{Final Answers:}
\[
\boxed{(1)\ a=1,\ b=1{,}000{,}000,\ c=100}
\]
\[
\boxed{(2)\ \text{choice (b)}}
\]
\[
\boxed{(3)\ 500}
\]

\end{document}
